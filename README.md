
# Educational Persistence Script

## Descripción

Este script está diseñado para ser utilizado en entornos controlados con fines educativos. Combina técnicas de persistencia, ocultación de procesos y escalación de privilegios en sistemas basados en Linux. El objetivo principal es concienciar sobre las vulnerabilidades de seguridad y cómo podrían ser explotadas por actores malintencionados.

## Funcionalidades

- **Ocultación de Procesos**: El script oculta su propio proceso para evitar la detección utilizando llamadas al sistema de bajo nivel (`syscall`).
- **Persistencia**: Crea un servicio en el sistema que garantiza que el script se ejecute automáticamente en cada inicio.
- **Conexión Segura**: Establece una conexión segura (SSL/TLS) con un servidor remoto para recibir y ejecutar comandos.
- **Escaneo de Vulnerabilidades**: El script escanea el sistema en busca de la vulnerabilidad `CVE-2021-3156` antes de intentar escalar privilegios.
- **Escalación de Privilegios**: Si se detecta una vulnerabilidad, el script intenta escalar privilegios para obtener acceso de superusuario (`root`).
- **Recopilación de Información del Sistema**: El script recoge información básica del sistema y la envía al servidor remoto.

## Requisitos

- **Python 3.x**
- **Sistemas Operativos**: Distribuciones de Linux vulnerables, como Ubuntu, Debian, CentOS, Red Hat, etc.
- **Librerías Python**: `ssl`, `socket`, `subprocess`, `ctypes`, `platform`

## Uso

1. **Instalación**:
   - Asegúrese de tener Python 3 instalado en el sistema objetivo.
   - Ejecute el script como un usuario con permisos suficientes para crear servicios y utilizar `sudo`.

2. **Ejecutar el Script**:
   - Puede ejecutar el script utilizando el siguiente comando:
   ```
   python3 persistence_script.py
   ```

3. **Detalles Técnicos**:
   - El script intentará conectarse a un servidor remoto en la IP `192.168.1.100` en el puerto `4444`.
   - Si se detecta una vulnerabilidad compatible, intentará escalar privilegios y reportará los resultados al servidor.

## Cuadro Explicativo

| Función                       | Descripción                                                                                                   |
|-------------------------------|---------------------------------------------------------------------------------------------------------------|
| `hide_process`                | Oculta el proceso del script en el sistema usando llamadas al sistema de bajo nivel (`syscall`). Esto es útil para evitar la detección del proceso por herramientas de monitoreo. |
| `compile_and_run_persistence` | Compila y ejecuta un pequeño programa en C que crea un servicio de persistencia en el sistema. Este servicio garantiza que el script se ejecute automáticamente en cada inicio del sistema. |
| `log_event`                   | Registra eventos importantes del script en un archivo de log. Esto incluye la ejecución de comandos, errores y otras actividades relevantes del script. |
| `get_system_info`             | Recopila información básica del sistema, como el nombre del sistema operativo, versión, nombre del host, procesador, arquitectura, usuario actual, y dirección IP. |
| `establish_secure_connection` | Establece una conexión segura utilizando SSL/TLS con un servidor remoto. Esta conexión se utiliza para recibir y ejecutar comandos del servidor. |
| `scan_vulnerabilities`        | Escanea el sistema en busca de vulnerabilidades específicas, como `CVE-2021-3156`, antes de intentar escalar privilegios. |
| `escalate_privileges`         | Si se detecta una vulnerabilidad, el script intenta escalar privilegios utilizando la vulnerabilidad detectada para obtener acceso de superusuario (`root`). |
| `main`                        | Función principal del script. Gestiona el flujo del programa, incluyendo la ocultación del proceso, la creación de persistencia, el escaneo de vulnerabilidades y la conexión remota. |

## Advertencia

**Este script es para uso educativo en entornos controlados. No debe ser utilizado en sistemas de producción sin autorización. El uso indebido de este script puede tener consecuencias legales.**
